[["horizontal-gene-transfer.html", "Chapter 4 Horizontal Gene Transfer 4.1 Taxonomic annotation of predicted genes 4.2 Evidence for bacterial HGT 4.3 Evidence for HGT from Ascomycota", " Chapter 4 Horizontal Gene Transfer To identify genuine Bacterial (or Fungal) Horizontal Gene Transfer, we apply the following protocol: sequence similarity search against non-redundant proteins database, including taxonomic annotations identify protein coding genes with best hits (top 5) to Bacterial proteins select assembled contigs where putative bacterial genes are discard short contigs with only one bacterial hit (Noise) if putative bacterial gene flanked by Eukaryotic genes, manual sequence similarity search to confirm a bona fide hit To have internal controls in this (and in the following analyses), we will add the ones of 18 S. cerevisiae industrial strains as well. 4.1 Taxonomic annotation of predicted genes For each predicted protein-coding gene, we can make a sequence similarity search against the non-redundant protein database at NCBI (nr). To assign the taxonomy id of the nr BLAST hit, we need the prot.accession2taxid.gz and nodes.dmp files provided by NCBI taxonomy. This can help us identify horizontal gene transfer and traces of contamination in the library prep of yeast samples. For each sample, first we do a blast search using DIAMOND, and then we associate to the protein_id of the top 5 best hits to the corresponding taxonomy the python library ete and customs scripts. BLAST is run against nr, excluding Saccharomyces cerevisiae, so that we can judge if the protein was present in other yeasts, or if it is indeed of bacterial origin. # BLAST search for file in *.all.maker.proteins.fasta; do ~/bin/DIAMOND/diamond blastp \\ --query $file \\ --db ~/taxonomy/nr \\ --taxonmap ~/taxonomy/prot.accession2taxid.gz \\ --taxonnodes ~/taxonomy/nodes.dmp \\ --threads 70 \\ --sensitive \\ --max-target-seqs 5 \\ --outfmt 6 qseqid sseqid pident length mismatch gapopen qstart qend sstart send evalue bitscore staxids &gt; $file.diamond done # BLAST to taxid for file in *.diamond; do ~/anaconda_ete/bin/python3.6 Vikings.tax.topath.py --input $file &gt; $file.tax done for file in *.tax ; do while read line ; do grep $line $file | cut -f 1,5; echo; done &lt; &lt;(grep Bacteria $file | cut -f 1 | sort -u) &gt; $file.bact done Now we have the full taxonomic annotation of the five best hits for each of the protein coding genes we annotated on the kveiks. 4.2 Evidence for bacterial HGT # filter annot.gff files for file in *.gff ; do grep CDS $file &gt; $(basename $file .gff).CDSonly.gff; gzip $file; done # identify putative bacterial genes and the assembled contigs harbouring them for file in *.tax; do cut -f 1,5 $file &gt; $file.all; done for file in *.all; do grep Bact $file &gt; $(basename $file .all).bact; done for file in *.bact; do while read line; do if [[ $line = &quot;&quot; ]]; then continue; else GENE=$(echo $line | cut -d &quot; &quot; -f 1 ); CHR=$(grep &quot;${GENE}&quot; $(basename $file .maker.proteins.fasta.diamond.tax.bact).CDSonly.gff | cut -f 1 ); grep &quot;${CHR}&quot; $(basename $file .bact).all \\ | uniq \\ | grep -C5 &quot;${GENE}&quot; \\ | grep -v &quot;${GENE}&quot; \\ &gt;&gt; $(basename $file .maker.proteins.fasta.diamond.tax.bact).&quot;${GENE}&quot;.tmp; fi; done &lt; &lt;(cut -f 1 $file | sort -u); done # pull the putative bacterial contigs for file in *.bact; do cut -f 1 $file | sort -u &gt; $file.lst; perl ~/scripts/SelectList_Fasta.pl \\ $(basename $file .diamond.tax.bact) \\ $file.lst \\ &gt; $file.fa; done # check if putative bacterial transcripts are flanked by Euk genes python3.6 Vikings.check_eukbact_contigs.1.py --input ../samples.lst for file in *HGT.table; do uniq $file &gt; temp; mv temp $file ; done for file in *HGT.table; do python3 ../Vikings.Bactmatch.py --input $file | cut -f 2 &gt; temp; cp temp temp2; paste temp temp2 | sed &#39;s/\\t/\\|\\&gt;/g&#39; &gt; $file.lst; rm temp temp2; done for file in *HGT.table.lst; do perl ~/scripts/SelectList_Fasta.pl \\ $(basename $file .HGT.table.lst).bact.fa \\ $file \\ &gt; $(basename $file .lst).fa; done THERE ARE NO EVIDENCES FOR SIGNIFICANT BACTERIAL HORIZONTAL GENE TRANSFER. 4.3 Evidence for HGT from Ascomycota We can check the presence of fungal non-Saccharomyces genes and operons starting from the DIAMOND blast results we have. # Select non Saccharomyces genes # filter for genes with no top hits to Saccharomyces for file in *tax; do grep Ascomycota $file | grep -v Saccharomyces &gt; $file.Asco; while read line; do grep $line $file &gt; $file.Asco.all; if [[ $(grep $line $file | grep Saccharomyces) ]]; then continue; else echo $line; fi; done &lt; &lt;(cut -f 1 $file.Asco | sort -u) &gt; $file.Asco.candidates; done # retrieve fasta sequences for file in *candidates; do perl ~/scripts/SelectList_Fasta.pl \\ ../../11_domestication/00_prot_DB/$(basename $file .diamond.tax.Asco.candidates) \\ $file &gt; $file.fa; done # generate table stats for i in 2 3; do wc -l *candidates \\ | sed &quot;s/.SPAdes.*//g&quot; \\ | sed &quot;s/.aa.*//g&quot; \\ | sed &quot;s/.contigs.*//g&quot; \\ | grep -v total \\ | sed &quot;s/ / /g&quot; \\ | sed &quot;s/ / /g&quot; \\ | cut -f $i -d &quot; &quot; \\ &gt; temp.$i; done; paste temp.3 temp.2 &gt; Vikings.Asco.HGT.stats; # clean up rm temp.2 temp.3 Kveik strains seems to have a significant higher number of Ascomycetes genes than the other industrial strains analysed. Are there additional proteins shared between all the kveiks (or by some kveiks with same geographical origin?). We can group these proteins in gene families and see if we see a common pattern. If not, we can BLAST back the proteins and see which specific genes have been acquired. # group candidates in gene families ~/bin/OrthoFinder-2.3.3/orthofinder -f ./ \\ -t 20 \\ -M msa \\ -S diamond \\ -A mafft \\ -T iqtree \\ -I 2 From OrthoFinder output we can identify 49 orthogroups containing four genes or more. We visualize them as heatmap, anc we can see that kveiks strains have a higher number of common additional orthogroups that are absent from S288C and industrial strains. Interestingly, the distribution pattern does not seem to overlap with the geographical isolation of the kveik culture. # import table heatfile = read.delim(paste(mainDir, &quot;Vikings.Asco.HGT.heatmap.tab&quot;, sep = &quot;&quot;), header = FALSE) # relevel heatfile$V2 = factor(heatfile$V2, levels = c(&quot;X1002&quot;, &quot;X1014&quot;, &quot;X1018&quot;, &quot;X1030&quot;, &quot;X1129&quot;, &quot;X5508&quot;, &quot;X1005&quot;, &quot;X1007&quot;, &quot;X1118&quot;, &quot;X1131&quot;, &quot;X1148&quot;, &quot;X7078-B&quot;, &quot;X1046&quot;, &quot;X4009&quot;, &quot;X4037&quot;, &quot;X4040&quot;, &quot;X4042&quot;, &quot;X4051&quot;, &quot;Voss1&quot;, &quot;SortdalEbbe1&quot;, &quot;Muri&quot;, &quot;Laerdal2&quot;, &quot;k7R25&quot;, &quot;Hornindal2&quot;, &quot;Hornindal1&quot;, &quot;Granvin1&quot;, &quot;9R40&quot;, &quot;8R19&quot;, &quot;7R7&quot;, &quot;6R15&quot;, &quot;46R37&quot;, &quot;46R12&quot;, &quot;45R11&quot;, &quot;45P5&quot;, &quot;44R7&quot;, &quot;44R32&quot;, &quot;42R31&quot;, &quot;42R20&quot;, &quot;41R15&quot;, &quot;41R10&quot;, &quot;40R20&quot;, &quot;40R1&quot;, &quot;40R14&quot;, &quot;3R11&quot;, &quot;39R20&quot;, &quot;38R16&quot;, &quot;2R23&quot;, &quot;28R8&quot;, &quot;28R33&quot;, &quot;28R21&quot;, &quot;28P6&quot;, &quot;28P1&quot;, &quot;27R17&quot;, &quot;21R38&quot;, &quot;21P1&quot;, &quot;1R16&quot;, &quot;19R18&quot;, &quot;17P5&quot;, &quot;16R37&quot;, &quot;16R23&quot;, &quot;14R6&quot;, &quot;14R30&quot;)) # prepare heatmap ggplot(heatfile) + geom_tile(aes(x = V1, y = V2, fill = V3)) + scale_fill_gradientn(na.value = &quot;white&quot;, limits = c(0, 2), colours = c(&quot;white&quot;, &quot;cyan&quot;, &quot;steelblue&quot;), breaks = c(0, 1, 2)) + coord_cartesian(expand = FALSE) + labs(fill = &quot;Gene counts&quot;, y = &quot;Strain&quot;, x = &quot;Orthologous groups&quot;) + theme(axis.title = element_text(size = 16), axis.text.x = element_text(angle = 90, hjust = 0.95, vjust = 0.5), legend.position = &quot;right&quot;, panel.border = element_rect(colour = &quot;black&quot;, fill = NA, size = 0.75)) + guides(fill = guide_colourbar(ticks.colour = &quot;black&quot;, frame.colour = &quot;black&quot;, frame.linewidth = 1)) Figure 4.1: Ascomycota HTG orthogroup candidates "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
